<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spreadsheet Formula Practice</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet/dist/css/luckysheet.css" />
  <link rel="stylesheet" href="style.css" /> 
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
  <div class="left-panel">
    <h2>Dolla Sign Y'all</h2>
    <p>
      Try writing the formula <code>=A2*D2</code> into B2. 
    </p>
    <p>
      Select B2 and use the blue square to drag the formula from B2 down to B6 and you'll see a problem. 
      When we drag a formula, the cell references get automatically updated, whether we want them to or not!
    </p>
    <p>
      Try again, but make the first formula: <code>=A2*$D$2</code>
    </p>
    <p>
      This formula says two important things:
      <ul>
        <li>The <code>$</code> in front of D says don't update the D. </li>
        <li>The <code>$</code> in front of 2 says don't update the 2. </li>
      </ul>
      In this case, we only needed one of those, but better safe than sorry!      
    </p>
    <p>
      Sometimes you might want to allow the row to change, but not the column. 
      Sometimes you might want to allow the column to change, but not the row. 
      In these cases, place the <code>$</code> accordingly. 
    </p>
    
    

    <button id="check-button">Check It</button>
    <div id="feedback-box"></div>
  </div>
  <div class="right-panel">
    <div id="luckysheet"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/luckysheet/dist/plugins/js/plugin.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/luckysheet/dist/luckysheet.umd.js"></script>
  <script src="sheets.js"></script>
  <script>

    let cell_data = [ {r:0,c:0,v:{v:"X"}},
                      {r:0,c:1,v:{v:"Y=X*D2"}},
                      {r:1,c:0,v:{v:"1"}},
                      {r:2,c:0,v:{v:"2"}},
                      {r:3,c:0,v:{v:"3"}},
                      {r:4,c:0,v:{v:"4"}},
                      {r:5,c:0,v:{v:"5"}},
                      {r:1,c:3,v:{v:"8"}}, ]; 

    luckysheet.create({
      container: 'luckysheet',
      data: [
        {
          name: "Sheet1",
          color: "",
          status: "1",
          order: "0",
          celldata: cell_data,
          config: {},
          index: 0
        }
      ],
      lang: 'en',
      allowEdit: true,
      showtoolbar: false,
      showinfobar: false,
      showsheetbar: false,
      showstatbar: false, 
    });

    document.getElementById("check-button").addEventListener("click", () => {  
        // Check for expected values in the sheet
        checkSheet(
            checkCellFunction("B2","=A2*$D$2") &&
            checkCellFunction("B5","=A5*$D$2") &&
            checkCellFunction("B6","=A6*$D$2"),
            "formulaselection.html"
        ); 
      });
  </script>
</body>
</html>








